# supervisord.conf

[supervisord]
nodaemon=true

# Gunicorn 进程配置
[program:gunicorn]
# Gunicorn 在容器内监听 127.0.0.1:5000
command=/usr/local/bin/gunicorn -w 4 -b 127.0.0.1:5000 app:app
directory=/app
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
stderr_logfile=/var/log/gunicorn/error.log
stdout_logfile=/var/log/gunicorn/access.log

# Nginx 进程配置
[program:nginx]
# Nginx 启动命令，-g "daemon off;" 确保它在前台运行
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
